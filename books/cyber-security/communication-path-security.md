---
title: 通信経路のセキュリティ
---
## 通信経路上でのセキュリティで意識するべき点

1. 通信内容の傍受
2. 通信内容の改ざん
3. 不正なサーバーとのやり取り（サーバーのなりすまし）
4. 不正なクライアントとのやり取り（クライアントのなりすまし）
5. 通信の妨害（DoS攻撃など）

## 中間者攻撃

通信経路上に中間者として入り込み様々な攻撃をする

### 例：ARP Spoofingによる中間者攻撃

IPアドレスのなりすましによる通信内容の傍受、改竄
これはLAN（ローカルエリアネットワーク）内で発生する攻撃手法である

**仕組み**
1. ユーザーのデバイスがある外部サイトに対して問い合わせをする際に、ユーザーデバイスが接続するローカルネットワーク内のルーターに対してパケットを送信するために、ルーターのIPアドレス[^2]に対応するMacアドレス[^1]を問い合わせる（これをARPリクエストと言う）

2. 攻撃者は、このローカルネットワーク内になんらかの方法で接続しておき、ARPリクエストに対して、自分のMacアドレスを返す（これをARPメッセージという）

3. ユーザーデバイスは、攻撃者からのARPメッセージを受けて、攻撃者の接続したデバイスをルーターと認識して、パケットを送信する

4. 攻撃者は、ユーザーデバイスからの通信内容を傍受することができる

[^1]: Macアドレスは、すべてのデバイスに与えられている`aa:bb:cc:dd:ee:ff`のような形式の物理アドレスである
[^2]: IPアドレスは、ネットワーク内でのアドレス

**[実際に日本であった事例（さくらインターネットの事例）](https://xtech.nikkei.com/it/article/COLUMN/20090225/325452/)**

![](https://storage.googleapis.com/zenn-user-upload/b971532ab125-20250715.png)

さくらインターネットのデータセンター内のサーバー1台に脆弱性が存在し、マルウェアに感染
このサーバーを経由して攻撃者が、データセンター内のローカルネットワーク内で`ARP Spoofing`をしかけた
他のサーバーがデフォルトゲートウェイ（ルーターのこと）を問い合わせた際に、マルウェアに感染したサーバーが自身のMacアドレスを応答
以降インターネットに出ていく通信の全てが感染サーバーを経由するようになり、通信データ内のHTMLコードなどに悪意のあるコードを埋め込まれるとエンドユーザーがマルウェアに感染してしまうという恐れがあった

## セキュアな通信を確立するための対策

セキュアな通信が持つべき性質

- 機密性：許可されたもの以外は通信内容を見ることができない
- 完全性：通信内容が改竄されないこと
- 可用性：何者かによって妨害されず、常にアクセスできる

**TLS(Transport Layer Security)**
HTTPSなどで使われるセキュアプロトコル
安全ではない、ネットワーク上で保護された通信経路を確立する
:::message
TLSによる暗号化はあくまで通信を暗号化するだけで、暗号化された通信内容自体の傍受を防いだり、正しい通信相手を保証するものではない
:::