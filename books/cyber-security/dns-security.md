---
title: DNSリクエストの監視によるセキュリティ
---

## DNSサーバーのログ監視によるセキュリティ対策
DNSサーバーはドメイン名とIPアドレスを結びつけるためのもの

### 1. ブラックリストに掲載された「ドメイン名の検知」

**攻撃者側のブラックリストによるIP制限への対策**
>C&CサーバーやフィッシングサーバーなどのIPアドレスはブラックリストに登録されてしまうと使えなくなってしまう

C&Cサーバーとフィッシングサーバーを別のIPにてホスティングしておいて、ドメイン名は固定して、そのドメイン名とIPアドレスの紐付けを動的に変更できるようにしておけば、ブラックリストに乗っていない新しいIPアドレスで悪性サービスを継続できる

**セキュリティ対策**
IPアドレスだけではなく、接続先のドメイン名も監視することが重要

### 2. 不審な「ドメイン名解決」の検知

**攻撃者のブラックリストによるドメイン制限への対策**
>同じドメイン名を使っていると、そのドメイン名をブラックリストに登録されてしまうと通信を遮断されてしまう

DGA(Domain Generation Algorithm)を活用することで、ドメイン名をランダムに生成する。
乱数などを用いることで、マルウェアが問い合わせる先のドメイン名をランダムに生成させるようにする。
攻撃者は、同じシードの乱数生成などで、問い合わせ先のドメインを予想して、そのドメイン名にC&Cサーバーを紐づけておく。
これにより、常にブラックリストに登録されていないドメイン名を使って通信することができる。

しかし、生成されたホスト名が存在しないホストであることもあるため、その場合はDNSエラーが発生する。
これによって、不審な活動を検知することができることがある。
